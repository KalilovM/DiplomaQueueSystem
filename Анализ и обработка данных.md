# Анализ и обработка данных
***
###### В этом документе изложено как, я обрабатывал и анализировал  [[данные Халык Банка]]
***
### Библеотеки
Я сначала импортировал все необходимые библеотеки.
`import pandas`   - эта библеотека в языке программирования Python позволяет работать с датафреймами.
`import numpy` - эта библеотека позволяет работать с листами и предоставляет возможность создавать новые numpy листы которые имеют расширенный функционал чем обычные листы в python
`import matplotlib.pyplot` - эта библеотека позволяет работать с визуализацией, и строить графики.
***
### Работа с данными
###### 1. Столбец сотрудники
![[Сотрудники до переименования.png]]При обработке был столбец сотрудников который имели слишком длмнные названия поэтому я переименовал в болле короткие и понятные названия с помощью цикла:
```
emps = df['employee'].unique()
for i in emps:
    z = i
    i = i.split()
    for j in range(len(i)):
        df['employee'] = df['employee'].replace(z,f'emp{i[1]}')
```
Итоговый вид после переименования стробца с сотрудниками:
![[Итоговый вид после переименования сотрудников.png]]
***
###### 2. Столбец услуги
Как видно из предыдущей картинки, услуги так же имеют очень длинные и сложные названия, что в дальнейшем привелобы к затруднениям при работе с этими данными.
Переименование столбца сервисы:
`df['service'].unique()` для определения всех существующих услуг в этом столбце. Далее переименование всех услуг в более короткое и понятное название:

```
df['service'] = df['service'].map({'ПЛАСТИКОВЫЕ КАРТЫ  106 кабинет':'plasticCard','ОБСЛУЖИВАНИЕ ЮРИДИЧЕСКИХ ЛИЦ 105 кабинет': "legalEntities", 'КАССА':'cashbox','АРЕНДА СЕЙФОВЫХ ЯЧЕЕК 105 кабинет ':'sefesRent', 'ДЕНЕЖНЫЕ ПЕРЕВОДЫ ':'moneyTransfer','СЧЕТА И ДЕПОЗИТЫ ФИЗИЧЕСКИХ ЛИЦ 106 кабинет':'individual','КРЕДИТЫ ДЛЯ УЧАСТНИКОВ ЗАРПЛАТНЫХ ПРОЕКТОВТИ ПЕНСИОНЕРОВ 104 кабинет':'loans','МЕЖБАНКОВСКИЕ ПЕРЕВОДЫ  ФИЗИЧЕСКИХ ЛИЦ 106 кабинет ':'interBankTransfers','ДОСРОЧНОЕ ПОГАШЕНИЕ КРЕДИТА И ПЕРЕСЧЕТ 107 кабинет':'earlyRepaymant','ИПОТЕКА':'mortgage','ПОТРЕБИТЕЛЬСКИЕ КРЕДИТЫ':'cosCredits','АВТО КРЕДИТЫ ':'carCredits','БИЗНЕС КРЕДИТЫ':'businessCred'})
```
 После переименования данные имели вид:
 ![[Итоговый вид после переименования сервисов.png]]
 ***
 ###### 3. Столбец приоритет
 Приоритет в [[Данные Халык Банка| данных ]] имел 4 значения это юридические, физические, касса и общий. Я так же переименовал их в более удобный и понятный формат. 
 ![[Исходный вид столбца приоритет.png]]	![[Итоговый вид столбца приоритет.png]]
 Демонстрация как данные выглядели до и после.
 ```
df['priority'] = df['priority'].map({'Приоритет ФЛ':'FL', 'Приоритет ЮР':'UR', 'КАССА':'CB', 'Приоритет ОБЩИЙ':'ALL'})
 ```
 Код который меняет названия данных в столбце приоритет.
 ***
 ###### 3. Столбец время ожидания
 Так как у нас в данных имеется 4 столбца:
 1. Время регистрации
 2. Время вызова
 3. Время окончания услуги
 4. Время обслуживания
 
То мы можем найти **время ожидания клиента**.
Для начало необходимо из типа объект перевести в обычный тип вермени и даты с которым умеет работать `pandas`. 
![[Исходный вид стобцов со временем.png]]
Для перевода в тип дата и время воспользовался обычным методом `pandas`:
```
df['registrationTime'] = pd.to_datetime(df['registrationTime'])
df['callTime'] = pd.to_datetime(df['callTime'])
df['serviceCompletion'] = pd.to_datetime(df['serviceCompletion'])
df['serviceTime'] = pd.to_datetime(df['serviceTime'])
```
Для понятного вида я решил перевести время сервиса в секунды.
```
df['serviceTime'] = df['serviceTime'].dt.hour * 3600 + \
              df['serviceTime'].dt.minute * 60 + \
              df['serviceTime'].dt.second
df['waitTime'] = df['callTime'] - df['registrationTime']
df['waitTime'] = df['waitTime'].dt.total_seconds()
```
Вид данных после перевода в тип дату и времени:
![[Итоговый вид столбцов со временем.png]]
После перевода можно спокойно работать с этими данными как с обычной датой и временем.
Теперь необходимо найти время ожидания клиента:
```
df['waitTime'] = df['callTime'] - df['registrationTime']
df['waitTime'] = df['waitTime'].dt.total_seconds()
```
Итоговый вид обработанных данных:
![[Итоговый вид обработанных данных.png]]